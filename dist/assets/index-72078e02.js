import{X as D,Y as w,Z as y,r as R,u as I,c as A,b as E,j as p,a,x as P,d,$ as v}from"./index-3dc75cc8.js";var q={},C=w;Object.defineProperty(q,"__esModule",{value:!0});var _=q.default=void 0,L=C(D()),M=y;_=q.default=(0,L.default)((0,M.jsx)("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");var b={},O=w;Object.defineProperty(b,"__esModule",{value:!0});var F=b.default=void 0,B=O(D()),U=y;F=b.default=(0,B.default)((0,U.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos");const z=()=>{const[g,h]=R.useState([]),$=I(),S=R.useRef(null),t=A.currentUser,{enqueueSnackbar:m}=E(),k=async c=>{const o=t==null?void 0:t.uid,s=c;return!!(s&&!(await d.collection("users").doc(s).collection("friendRequests").where("sender","==",o).where("recipient","==",s).limit(1).get()).empty)};R.useEffect(()=>{(async()=>{try{const o=d.collection("users"),s=o.doc().id,r=await o.orderBy(v.firestore.FieldPath.documentId()).startAt(s).limit(5).get();if(r.empty)console.log("No random documents found.");else{const n=await Promise.all(r.docs.map(async e=>{const i=e.data(),l=await k(i.uid);return{...i,friendRequestSent:l}}));h(n)}}catch(o){console.error("Error fetching random documents:",o)}})()},[]);const j=(c,o,s)=>{const r=t==null?void 0:t.uid,n=o,e=d.batch(),i=d.collection("users").doc(n).collection("friendRequests").doc(r),l=d.collection("users").doc(n).collection("notifications").doc(r);if(c)e.delete(i),e.delete(l),e.commit().then(()=>{const u=[...g];u[s].friendRequestSent=!1,h(u),m("Friend Request Declined",{variant:"success"})}).catch(u=>{m(`Error Occurred: ${u}`,{variant:"error"})});else{const u={sender:r,recipient:n,timestamp:v.firestore.FieldValue.serverTimestamp()},x={recipient:n,sender:r,message:"You have received a friend request",timestamp:v.firestore.FieldValue.serverTimestamp()};e.set(i,u),e.set(l,x),e.commit().then(()=>{const f=[...g];f[s].friendRequestSent=!0,h(f),m("Friend Request Sent",{variant:"success"})}).catch(f=>{m(`Error Occurred: ${f}`,{variant:"error"})})}},N=c=>{S.current.scrollLeft+=c};return p("div",{className:`suggestion-main-container ${t!=null&&t.isAnonymous?"top-margin":""}`,children:[a("button",{className:"suggestion-scroll-btn suggestion-scroll-btn-left",onClick:()=>N(-160),children:a(_,{className:"suggestion-scroll"})}),a("ul",{className:"suggestion-user-container",ref:S,children:g.map((c,o)=>{const{photoURL:s,username:r,name:n,uid:e,bio:i,friendRequestSent:l}=c;return p("li",{className:"suggestion-user-list-item",onClick:()=>$(`/user/${r}`),children:[a("img",{src:s||P,alt:n||"user",className:"suggestion-user-img"}),p("div",{className:"suggestion-user-data",children:[a("h4",{className:"suggestion-user-name",children:n}),a("p",{className:"suggestion-user-bio",children:i||"..."}),e!==(t==null?void 0:t.uid)&&a("button",{className:"suggestion-user-btn button",onClick:u=>{u.stopPropagation(),j(l,e,o)},children:l?"Remove Request":"Add Friend"})]})]},e)})}),a("button",{className:"suggestion-scroll-btn suggestion-scroll-btn-right",onClick:()=>N(160),children:a(F,{className:"suggestion-scroll"})})]})};export{z as default};
