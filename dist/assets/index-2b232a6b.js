import{r as l,a as e,j as d,a1 as E,F as v,d as m,bc as S}from"./index-1a3dc146.js";import{d as k}from"./Delete-4ed43f71.js";const U=({username:r,setViewStory:y,setUserData:N})=>{var p;const[g,n]=l.useState({}),[h,i]=l.useState(""),{imageUrl:f,caption:u,background:_}=g,w="linear-gradient(130deg, #dee2ed, #dee2ed, #9aa9d1, #b6c8e3, #b6afd0, #d3c0d8)";l.useEffect(()=>{async function a(){try{const o=await m.collection("story").where("username","==",r).limit(1).get();if(o.empty)n(null),i([]);else{const c=o.docs[0].data();n({...c}),i((c==null?void 0:c.imageUrl)||[])}}catch(t){console.error("Error fetching story data:",t),n(null),i([])}}a()},[r]);async function b(){const a=await m.collection("story").where("username","==",r).get();a==null||a.forEach(o=>{o.ref.delete().catch(s=>{console.error("Error deleting document: ",s)})});const t=await m.collection("users").where("username","==",r).get();t==null||t.forEach(o=>{o.ref.update({storyTimestamp:S()}).then(()=>{N(s=>({...s,storyTimestamp:null}))}).catch(s=>{console.error("Error deleting document: ",s)})})}return e("div",{className:"story_main_container",children:d("div",{className:`story-container-outer ${f?"story-cont-with-img":"story-cont-without-img"} `,style:{},children:[e(E,{style:{},className:"story_icons story_close_icon",onClick:()=>y(!1)}),g?d(v,{children:[e(k,{style:{},className:"story_icons story_delete_icon",onClick:()=>{b(),y(!1)}}),f==""?e("div",{className:"story-img",children:e("div",{className:"story_bg",style:{background:_||w},children:e("p",{className:"caption_without_image",children:u})})}):d("div",{className:"story_container-inner",children:[e("div",{className:"story-image-container",children:e("img",{src:h&&((p=h[0])==null?void 0:p.imageUrl),alt:r,className:"story_image"})}),e("p",{className:"story-caption",children:u})]})]}):e("p",{style:{color:"white"},children:"SorryðŸ˜“ No story!"})]})})};export{U as default};
