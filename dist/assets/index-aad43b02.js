import{X as _,Y as D,Z as w,r as R,u as I,c as A,b as E,j as p,a,x as P,d,$ as v}from"./index-1a3dc146.js";var q={},C=D;Object.defineProperty(q,"__esModule",{value:!0});var y=q.default=void 0,L=C(_()),M=w,O=(0,L.default)((0,M.jsx)("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");y=q.default=O;var b={},B=D;Object.defineProperty(b,"__esModule",{value:!0});var $=b.default=void 0,U=B(_()),V=w,z=(0,U.default)((0,V.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos");$=b.default=z;const Y=()=>{const[g,h]=R.useState([]),F=I(),S=R.useRef(null),t=A.currentUser,{enqueueSnackbar:m}=E(),k=async c=>{const r=t==null?void 0:t.uid,s=c;return!!(s&&!(await d.collection("users").doc(s).collection("friendRequests").where("sender","==",r).where("recipient","==",s).limit(1).get()).empty)};R.useEffect(()=>{(async()=>{try{const r=d.collection("users"),s=r.doc().id,o=await r.orderBy(v.firestore.FieldPath.documentId()).startAt(s).limit(5).get();if(o.empty)console.log("No random documents found.");else{const n=await Promise.all(o.docs.map(async e=>{const i=e.data(),l=await k(i.uid);return{...i,friendRequestSent:l}}));h(n)}}catch(r){console.error("Error fetching random documents:",r)}})()},[]);const j=(c,r,s)=>{const o=t==null?void 0:t.uid,n=r,e=d.batch(),i=d.collection("users").doc(n).collection("friendRequests").doc(o),l=d.collection("users").doc(n).collection("notifications").doc(o);if(c)e.delete(i),e.delete(l),e.commit().then(()=>{const u=[...g];u[s].friendRequestSent=!1,h(u),m("Friend Request Declined",{variant:"success"})}).catch(u=>{m(`Error Occurred: ${u}`,{variant:"error"})});else{const u={sender:o,recipient:n,timestamp:v.firestore.FieldValue.serverTimestamp()},x={recipient:n,sender:o,message:"You have received a friend request",timestamp:v.firestore.FieldValue.serverTimestamp()};e.set(i,u),e.set(l,x),e.commit().then(()=>{const f=[...g];f[s].friendRequestSent=!0,h(f),m("Friend Request Sent",{variant:"success"})}).catch(f=>{m(`Error Occurred: ${f}`,{variant:"error"})})}},N=c=>{S.current.scrollLeft+=c};return p("div",{className:`suggestion-main-container ${t!=null&&t.isAnonymous?"top-margin":""}`,children:[a("button",{className:"suggestion-scroll-btn suggestion-scroll-btn-left",onClick:()=>N(-160),children:a(y,{className:"suggestion-scroll"})}),a("ul",{className:"suggestion-user-container",ref:S,children:g.map((c,r)=>{const{photoURL:s,username:o,name:n,uid:e,bio:i,friendRequestSent:l}=c;return p("li",{className:"suggestion-user-list-item",onClick:()=>F(`/user/${o}`),children:[a("img",{src:s||P,alt:n||"user",className:"suggestion-user-img"}),p("div",{className:"suggestion-user-data",children:[a("h4",{className:"suggestion-user-name",children:n}),a("p",{className:"suggestion-user-bio",children:i||"..."}),e!==(t==null?void 0:t.uid)&&a("button",{className:"suggestion-user-btn button",onClick:u=>{u.stopPropagation(),j(l,e,r)},children:l?"Remove Request":"Add Friend"})]})]},e)})}),a("button",{className:"suggestion-scroll-btn suggestion-scroll-btn-right",onClick:()=>N(160),children:a($,{className:"suggestion-scroll"})})]})};export{Y as default};
